<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Streamline Dashboard</title>
    <link rel="icon" type="image/png" href="//fast.decentespresso.com/favicon-32x32.png" sizes="32x32">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.11.1/dist/full.min.css" rel="stylesheet" type="text/css" />
    <link href="src/css/dark-mode.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.plot.ly/plotly-3.2.0.min.js" charset="utf-8"></script>
    <script src="src/modules/app.js" type="module"></script>
    <script src="src/modules/reconnecting-websocket.js"></script>
    <style>
        
        /* Custom Inter font from local files */
        @font-face { font-family: 'Inter'; src: url('src/ui/Inter-Thin.ttf') format('truetype'); font-weight: 100; }
        @font-face { font-family: 'Inter'; src: url('src/ui/Inter-ExtraLight.ttf') format('truetype'); font-weight: 200; }
        @font-face { font-family: 'Inter'; src: url('src/ui/Inter-Light.ttf') format('truetype'); font-weight: 300; }
        @font-face { font-family: 'Inter'; src: url('src/ui/Inter-Regular.ttf') format('truetype'); font-weight: 400; }
        @font-face { font-family: 'Inter'; src: url('src/ui/Inter-Medium.ttf') format('truetype'); font-weight: 500; }
        @font-face { font-family: 'Inter'; src: url('src/ui/Inter-SemiBold.ttf') format('truetype'); font-weight: 600; }
        @font-face { font-family: 'Inter'; src: url('src/ui/Inter-Bold.ttf') format('truetype'); font-weight: 700; }
        @font-face { font-family: 'Inter'; src: url('src/ui/Inter-ExtraBold.ttf') format('truetype'); font-weight: 800; }
        @font-face { font-family: 'Inter'; src: url('src/ui/Inter-Black.ttf') format('truetype'); font-weight: 900; }

        body {
            font-family: 'Inter', sans-serif;
        }
        
        :root {
            --mimoja-blue-v2: #385A92;
            --mimoja-blue: #385A92; 
            
            --low-contrast-white: #959595;
            --dark-gray: #121212;
            --green: #0CA581;
            --button-grey: #EDEDED;
            
            /* Plus Minus Flash Colors (Light Mode) */
            --plus-minus-flash-on-color: #b8b8b8;
            --plus-minus-flash-on-color2: #cfcfcf;
            --plus-minus-flash-off-color: #ededed;
        }

        [data-theme='dark'] {
            /* Plus Minus Flash Colors (Dark Mode) */
            --plus-minus-flash-on-color: #272A34;
            --plus-minus-flash-on-color2: #1a1d25;
            --plus-minus-flash-off-color: #101115;
        }

        .flash {
            background-color: #395ab9 !important;
            color: white !important;
            border-radius: 0.5rem;
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
        }
    </style>
</head>
<body class="bg-base-100 text-base-content  w-screen min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-base-200 p-2 flex justify-between items-center border-b border-base-300">
        <!-- Profile Favorites  md:h-12 lg:h-12-->
        <nav class="flex gap-2 flex-wrap">
            <button id="fav-profile-btn-0" class="btn min-h-0 text-balance btn-outline border-[var(--mimoja-blue)] text-[var(--mimoja-blue)] rounded-lg min-w-20 max-w-40 h-12 md:h-12 lg:h-12 text-sm md:text-xs ">Profile 1</button>
            <button id="fav-profile-btn-1" class="btn min-h-0 text-balance btn-outline border-[var(--mimoja-blue)] text-[var(--mimoja-blue)] rounded-lg min-w-20 max-w-40 h-12 md:h-12 lg:h-12 text-sm md:text-xs">Profile 2</button>
            <button id="fav-profile-btn-2" class="btn min-h-0 py-1 px-1 text-balance btn-outline flex justify-center items-center text-center max-w-40 h-12 min-w-20 md:text-xs border-[var(--mimoja-blue)] text-[var(--mimoja-blue)] rounded-lg text-sm">Profile 3</button> 
            <button id="fav-profile-btn-3" class="btn min-h-0 text-balance btn-outline border-[var(--mimoja-blue)] text-[var(--mimoja-blue)] rounded-lg max-w-40 min-w-20 h-12 md:h-12 lg:h-12 text-sm md:text-xs">Adaptive v2</button>
            <button id="fav-profile-btn-4" class="btn min-h-0 py-1 px-1 text-balance btn-outline border-[var(--mimoja-blue)] text-[var(--mimoja-blue)] rounded-lg max-w-40 min-w-20 h-12 md:h-12 lg:h-12 text-sm md:text-xs">Flow Profile for Milk Drinks</button>
        </nav>
        <!-- Right side controls -->
        <div class="flex gap-2 items-center md:gap-2">
            <input type="checkbox" id="theme-toggle" class="toggle toggle-sm" />
            <button class="btn btn-outline min-h-0 border-solid  border-[var(--mimoja-blue)] text-[var(--mimoja-blue)] rounded-xl  h-6 md:h-6 lg:h-6 text-lg md:text-xs lg:text-xs settings-button">Settings</button>
            
            <button id="sleep-button" class="btn btn-outline border-[var(--mimoja-blue)] text-[var(--mimoja-blue)] min-h-0 rounded-xl h-6 md:h-6 lg:h-6 text-lg md:text-xs lg:text-xs">Sleep</button>
        </div>
    </header>

    <div class="flex-grow flex">
        <!-- Left Sidebar: Shot Settings -->
        <aside class="bg-base-200 p-4 md:p-2 flex flex-col justify-between border-r border-base-300">
            <!-- Grind -->
            <div class="flex justify-between items-center w-full">
                <span class="w-24 text-lg md:text-lg font-bold text-[var(--mimoja-blue-v2)]">Grind</span>
                <div class="grid grid-cols-[auto_90px_auto] items-center gap-x-2">
                    <button id="grind-minus" class="btn btn-sm md:btn-sm bg-[var(--button-grey)] font-extralight text-[29px]">-</button>
                    <span id="grind-value" class="text-xl md:text-lg font-bold text-center">1.4</span>
                    <button id="grind-plus" class="btn btn-sm md:btn-sm bg-[var(--button-grey)] font-extralight text-[29px]">+</button>
                </div>
            </div>
            <!-- Dose In -->
            <div class="flex justify-between items-center w-full">
                <span class="w-24 text-lg md:text-lg font-bold text-[var(--mimoja-blue-v2)]">Dose</span>
                <div class="grid grid-cols-[auto_90px_auto] items-center gap-x-2">
                    <button id="dose-in-minus" class="btn btn-sm md:btn-sm bg-[var(--button-grey)] font-extralight text-[29px]">-</button>
                    <span id="dose-in-value" class="text-xl md:text-lg font-bold text-center">20g</span>
                    <button id="dose-in-plus" class="btn btn-sm md:btn-sm bg-[var(--button-grey)] font-extralight text-[29px]">+</button>
                </div>
            </div>
            <!-- Drink out -->
            <div class="flex justify-between items-center  w-full">
                 <span class="w-24 text-nowrap text-lg md:text-lg font-bold text-[var(--mimoja-blue-v2)]">Drink</span>
                <div class="grid grid-cols-[auto_90px_auto] items-center gap-x-2">
                    <button id="drink-out-minus" class="btn btn-sm md:btn-sm bg-[var(--button-grey)] font-extralight text-[29px]">-</button>
                    <div class="text-center w-full">
                        <span id="drink-out-value" class="text-xl md:text-lg font-bold w-full block">46g</span>
                        <span id="drink-ratio-value" class="text-sm md:text-xs text-gray-500 block">(1:2.3)</span>
                    </div>
                    <button id="drink-out-plus" class="btn btn-sm md:btn-sm bg-[var(--button-grey)] font-extralight text-[29px]">+</button>
                </div>
            </div>
            <div id="drink-out-presets" class="flex  justify-start justify-between items-center w-full">
                <button id="drink-out-preset-1" class="text-sm md:text-xs  text-gray-400">18:36</button>
                <button id="drink-out-preset-2" class="text-sm md:text-xs text-gray-400">20:40</button>
                <button id="drink-out-preset-3" class="text-sm md:text-xs text-gray-400">22:44</button>
                <button id="drink-out-preset-4" class="text-sm md:text-xs text-gray-400">20:46</button>
            </div>
            <div class="divider"></div>
            <!-- Temp -->
             <div class="flex justify-between items-center w-full">
                <span class="w-24 text-lg md:text-lg font-bold text-[var(--mimoja-blue-v2)]">Brew</span>
                <div class="grid grid-cols-[auto_90px_auto] items-center gap-x-2">
                    <button id="temp-minus" class="btn btn-sm md:btn-sm bg-[var(--button-grey)] font-extralight text-[29px]">-</button>
                    <span id="temp-value" class="text-xl md:text-lg font-bold text-center">92°c</span>
                    <button id="temp-plus" class="btn btn-sm md:btn-sm bg-[var(--button-grey)] font-extralight text-[29px]">+</button>
                </div>
            </div>
            <div id="temp-presets" class="flex  justify-start justify-between items-center w-full">
                <button id="temp-preset-75" class="text-sm md:text-xs text-gray-400">75°c</button>
                <button id="temp-preset-80" class="text-sm md:text-xs text-gray-400">80°c</button>
                <button id="temp-preset-85" class="text-sm md:text-xs text-gray-400">85°c</button>
                <button id="temp-preset-92" class="text-sm md:text-xs text-gray-400">92°c</button>
            </div>
             <div class="divider"></div>
            <!-- Steam -->
            <div class="flex justify-between items-center w-full">
                <div>
                    <span class="w-24 text-lg md:text-lg font-bold text-[var(--mimoja-blue-v2)]">Steam</span>
                    <span id="steam-mode-toggle" class="text-base text-xs text-nowrap block cursor-pointer">
                        <span id="steam-mode-time">Time</span> | <span id="steam-mode-flow">Flow</span>
                    </span>
                </div>
                <div class="grid grid-cols-[auto_90px_auto] items-center gap-x-2">
                    <button id="steam-minus" class="btn btn-sm md:btn-sm bg-[var(--button-grey)] font-extralight text-[29px]">-</button>
                    <div class="text-center w-full">
                        <span id="steam-duration-value" class="text-lg block font-bold w-full">30s</span>
                        <span id="steam-flow-value" class="text-xs text-gray-500 block w-full">1.0ml/s</span>
                    </div>
                    <button id="steam-plus" class="btn btn-sm md:btn-sm bg-[var(--button-grey)] font-extralight text-[29px]">+</button>
                </div>
            </div>
            <div id="steam-presets" class="flex justify-start justify-between items-center w-full">
                <button id="steam-preset-1" class="text-sm md:text-xs text-gray-400">15s</button>
                <button id="steam-preset-2" class="text-sm md:text-xs text-gray-400">30s</button>
                <button id="steam-preset-3" class="text-sm md:text-xs text-gray-400">45s</button>
                <button id="steam-preset-4" class="text-sm md:text-xs text-gray-400">60s</button>
            </div>
            <div id="steam-flow-presets" class="flex hidden justify-start justify-between items-center w-full">
                <button id="steam-flow-preset-1" class="text-sm md:text-xs text-gray-400">0.5ml/s</button>
                <button id="steam-flow-preset-2" class="text-sm md:text-xs text-gray-400">1.0ml/s</button>
                <button id="steam-flow-preset-3" class="text-sm md:text-xs text-gray-400">1.5ml/s</button>
                <button id="steam-flow-preset-4" class="text-sm md:text-xs text-gray-400">2.0ml/s</button>
            </div>
            <div class="divider"></div>
            <!-- Flush -->
            <div class="flex justify-between gap-2 items-center w-full">
                <span class="w-24 text-lg md:text-lg font-bold text-[var(--mimoja-blue-v2)]">Flush</span>
                <div class="grid grid-cols-[auto_90px_auto] items-center gap-x-2">
                    <button id="flush-minus" class="btn btn-sm md:btn-sm bg-[var(--button-grey)] font-extralight text-[29px]">-</button>
                    <span id="flush-value" class="text-xl md:text-lg font-bold text-center">5s</span>
                    <button id="flush-plus" class="btn btn-sm md:btn-sm bg-[var(--button-grey)] font-extralight text-[29px]">+</button>
                </div>
            </div>
                <div id="flush-presets" class="flex  justify-start justify-between items-center w-full">
                <button id="flush-preset-0" class="text-sm md:text-xs text-gray-400">5s</button>
                <button id="flush-preset-1" class="text-sm md:text-xs text-gray-400">10s</button>
                <button id="flush-preset-2" class="text-sm md:text-xs text-gray-400">15s</button>
                <button id="flush-preset-3" class="text-sm md:text-xs text-gray-400">20s</button>
                </div>
            
            <div class="divider"></div>
            <!-- Hot Water -->
            <div class="flex  justify-between gap-2 items-center w-full">
                <div>
                    <span class="max-w-24 text-nowrap text-lg md:text-lg font-bold text-[var(--mimoja-blue-v2)]">Hot Water</span>
                    <span id="hot-water-mode-toggle" class="text-base text-xs text-nowrap block cursor-pointer">
                        <span id="hot-water-mode-temp">Temp</span> | <span id="hot-water-mode-vol">Vol</span>
                    </span>
                </div>
                <div class="grid grid-cols-[auto_90px_auto] items-center gap-x-2">
                    <button id="hot-water-vol-minus" class="btn btn-sm md:btn-sm bg-[var(--button-grey)] font-extralight text-[29px]">-</button>
                    <div class="text-center w-full">
                        <span id="hot-water-vol-value" class="text-lg  w-full block  font-bold">75ml</span>
                        <span id="hot-water-temp-value" class="text-xs  text-gray-500 block">45°C</span>
                    </div>
                    <button id="hot-water-vol-plus" class="btn btn-sm md:btn-sm bg-[var(--button-grey)] font-extralight text-[29px]">+</button>
                </div>
                </div>
                <div id="hotwater-presets" class="flex  justify-start justify-between items-center w-full">
                <button id="hotwater-temp-preset0" class="text-sm md:text-xs text-gray-400">75°c</button>
                <button id="hotwater-temp-preset1" class="text-sm md:text-xs text-gray-400">80°c</button>
                <button id="hotwater-temp-preset2" class="text-sm md:text-xs text-gray-400">85°c</button>
                <button id="hotwater-temp-preset3" class="text-sm md:text-xs text-gray-400">92°c</button>
            </div>
        </aside>

        <!-- Main Content: Graph and Status -->
        <main class="flex flex-col min-h-0 flex-grow">
            <div class="p-4  flex flex-col md:flex-row justify-between items-start">
                <div>   
                    <h1 id="profile-name" class="text-2xl md:text-xl font-bold text-[var(--mimoja-blue-v2)] flex items-center gap-2">
                        Damian’s LRv2 Long Name Profile
                        <!-- <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 md:w-9 md:h-9" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg> -->
                    </h1>
                    <div class="flex gap-2 md:gap-3 text-base md:text-lg mt-0.5 flex-wrap">
                        <p><span class="font-semibold">Mix</span> <span id="data-mix-temp" class="text-gray-600">°c</span></p>
                        <p><span class="font-semibold">Group</span> <span id="data-group-temp" class="text-gray-600">°c</span></p>
                        <p><span class="font-semibold">Steam</span> <span id="data-steam-temp" class="text-gray-600">°c</span></p>
                        <p><span class="font-semibold">Tank</span> <span id="data-tank-vol" class="text-gray-600">ml</span></p>
                        <p><span class="font-semibold">Weight</span> <span id="data-weight" class="text-gray-600"> g</span></p>

                    </div>
                </div>
                <div id="machine-status" class="text-2xl  font-bold text-[var(--green)] mt-2 md:mt-0 md:text-xl">
                    Connecting
                </div>
            </div>
            
            <!-- Plotly Chart Container -->
            <div id="plotly-chart" class="w-full flex-grow"></div>
            
            <!-- Footer: Shot History and Data -->
            <footer class="bg-base-100 p-4 md:p-4 border-t-2 flex flex-col md:flex-row gap-4 md:gap-4">
                <!-- Shot History -->
                <div class="flex-none w-full md:w-1/3">
                    <h2 class="text-lg md:textarea-sm font-semibold text-center mb-1 md:mb-1">SHOT HISTORY</h2>
                    <div class="flex items-center justify-between">
                        <button id="history-prev-btn" class="btn btn-ghost">◀</button>
                        <div class="text-center">
                            <p id="history-date" class="text-xl md:text-xl font-bold">Tue, 14 Sept, 18:45</p>
                            <p id="history-profile-name" class="text-lg md:text-lg">Londinium</p>
                        </div>
                        <button id="history-next-btn" class="btn btn-ghost">▶</button>
                    </div>
                </div>
                <!-- Shot Data -->
                <div class="flex-grow">
                     <h2 class="text-lg md:text-lg font-semibold mb-2 md:mb-4">SHOT DATA</h2>
                     <div class="overflow-x-auto">
                         <table class="table table-xs md:table-xs">
                            <thead>
                                <tr class="text-sm md:text-sm">
                                    <th></th>
                                    <th>Time</th>
                                    <th>Grams</th>
                                    <th>mL</th>
                                    <th>°C</th>
                                    <th>mL/s</th>
                                    <th>Pressure</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="text-xs md:text-xs">
                                    <th class="font-semibold">Preinfusion</th>
                                    <td id="shot-data-pi-time">15s</td>
                                    <td id="shot-data-pi-weight">10g</td>
                                    <td id="shot-data-pi-volume">17ml</td>
                                    <td id="shot-data-pi-temp">90°c</td>
                                    <td id="shot-data-pi-flow">0-8.1 </td>
                                    <td id="shot-data-pi-pressure">0-3.3 bar</td>
                                </tr>
                                 <tr class="text-xs md:text-xs">
                                    <th class="font-semibold">Extraction</th>
                                    <td id="shot-data-ex-time">30s</td>
                                    <td id="shot-data-ex-weight">29g</td>
                                    <td id="shot-data-ex-volume">30ml</td>
                                    <td id="shot-data-ex-temp">90°-80°c</td>
                                    <td id="shot-data-ex-flow">0.4-2.5 </td>
                                    <td id="shot-data-ex-pressure">3-9 bar</td>
                                </tr>
                                 <tr class="text-sm md:text-sm font-bold">
                                    <th class="font-semibold">Total</th>
                                    <td id="shot-data-total-time">45s</td>
                                    <td id="shot-data-total-weight">39g (1:2.5)</td>
                                    <td id="shot-data-total-volume">57ml</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>
                            </tbody>
                         </table>
                    </div>
                </div>
            </footer>
        </main>
    </div>

    <!-- Profile Selection Modal -->
    <dialog id="profile_modal" class="modal">
        <div class="modal-box">
            <h3 class="font-bold text-lg">Choose a Profile</h3>
            <div id="profile-list-container" class="py-4 grid grid-cols-1 gap-2">
                <!-- Profile list will be inserted here by JavaScript -->
            </div>
            <div class="modal-action">
                <button id="upload-profile-btn" class="btn">Upload a Profile</button>
                <input type="file" id="profile-upload-input" class="hidden" accept=".json">
                <form method="dialog">
                    <button class="btn">Close</button>
                </form>
            </div>
        </div>
    </dialog>

</body>
</html>